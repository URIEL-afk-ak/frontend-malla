(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[942],{4008:(e,i,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/horario",function(){return n(9838)}])},9838:(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>l});var t=n(7876),o=n(4232);let a=["Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes"],r=Array.from({length:17},(e,i)=>"".concat((7+i).toString().padStart(2,"0"),":00"));function l(){var e,i,n,l,d,s;let[c,h]=(0,o.useState)([]),[p,m]=(0,o.useState)({}),[f,u]=(0,o.useState)({open:!1,materia:null}),[g,b]=(0,o.useState)([]),[x,y]=(0,o.useState)({open:!1,bloque:null,materia:null});(0,o.useEffect)(()=>{fetch("".concat("http://localhost:5000","/api/horarios")).then(e=>e.json()).then(e=>{if("success"===e.status&&e.data){h(e.data);let i={};e.data.forEach(e=>{e.Horarios&&e.Horarios.length>0&&(i[e.id]=e.Horarios.map(e=>({dia:e.dia,inicio:e.inicio,fin:e.fin,aula:e.aula})))}),m(i)}})},[]);let j=()=>{u({open:!1,materia:null}),b([])},v=(e,i,n)=>{b(t=>t.map((t,o)=>o===e?{...t,[i]:n}:t))},w=()=>{y({open:!1,bloque:null,materia:null})};return(0,t.jsxs)("div",{style:{width:"100vw",minHeight:"100vh",maxWidth:"100vw",margin:"0",padding:"4em 0 0 0",background:"#e5e7eb",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"center",overflowX:"hidden"},children:[(0,t.jsx)("style",{children:"\n        .calendario-semanal {\n          width: 98vw;\n          max-width: 100vw;\n          min-width: 0;\n          height: clamp(350px, 60vh, 600px);\n          min-height: 320px;\n          max-height: 70vh;\n          border-collapse: separate;\n          border-spacing: 0;\n          background: #f1f5fa;\n          font-family: 'Segoe UI', Arial, sans-serif;\n          box-shadow: 0 8px 32px #2563eb33;\n          border-radius: 18px;\n          overflow: hidden;\n          table-layout: fixed;\n        }\n        .calendario-semanal th {\n          background: linear-gradient(90deg, #dbeafe 60%, #e0e7ff 100%);\n          color: #1e293b;\n          font-size: clamp(1.1em, 2vw, 1.7em);\n          font-weight: 800;\n          letter-spacing: 0.04em;\n          padding: 0.3em 0;\n          border-bottom: 2.5px solid #2563eb55;\n        }\n        .calendario-semanal .hora {\n          background: #e5e7eb;\n          color: #64748b;\n          font-size: 0.85em;\n          font-weight: 500;\n          text-align: right;\n          padding: 0.1em 0.3em;\n          border-right: 2px solid #2563eb22;\n          min-width: 38px;\n          max-width: 38px;\n        }\n        .calendario-semanal td {\n          background: #fff;\n          border: none;\n          min-width: 90px;\n          max-width: 1fr;\n          height: 2em;\n          font-size: 0.98em;\n          color: #1e293b;\n          vertical-align: top;\n          padding: 0;\n        }\n        .calendario-semanal td.vacio {\n          background: #f3f4f6;\n          color: #cbd5e1;\n          border: none;\n        }\n        .calendario-semanal tr:last-child td, .calendario-semanal tr:last-child .hora {\n          border-bottom: none;\n        }\n        .calendario-semanal td:last-child, .calendario-semanal th:last-child {\n          border-right: none;\n        }\n        /* Bloques de materia en el calendario */\n        .bloque-materia {\n          margin: 0.2em 0.3em;\n          background: linear-gradient(120deg, #e0e7ff 60%, #bae6fd 100%);\n          border-radius: 16px;\n          box-shadow: 0 2px 8px #2563eb22;\n          border: 2px solid #60a5fa;\n          padding: 0.7em 0.5em;\n          font-weight: 700;\n          color: #1e293b;\n          font-size: 1.08em;\n          cursor: pointer;\n          transition: box-shadow 0.2s;\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          justify-content: center;\n          height: 100%;\n        }\n        .bloque-materia span {\n          font-weight: 500;\n          color: #2563eb;\n          font-size: 1em;\n          text-align: center;\n        }\n        .bloque-materia:hover {\n          box-shadow: 0 4px 16px #2563eb44;\n        }\n      "}),(0,t.jsx)("div",{style:{width:"100%",maxWidth:"100vw",margin:"2em auto 0 auto",overflowX:"auto"},children:(0,t.jsxs)("table",{className:"calendario-semanal",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{}),a.map(e=>(0,t.jsx)("th",{children:e},e))]})}),(0,t.jsx)("tbody",{children:(()=>{let e={},i=[];for(let n=0;n<r.length;n++){let o=r[n],l=[(0,t.jsx)("td",{className:"hora",children:o},-1)];for(let i=0;i<a.length;i++){let d=a[i],s="".concat(n,"-").concat(i);if(e[s])continue;let h=null,m=!1;for(let e of c)for(let i of function(e){if(!e||0===e.length)return[];let i=[...e].sort((e,i)=>e.dia!==i.dia?e.dia.localeCompare(i.dia):e.inicio.localeCompare(i.inicio)),n=[];for(let e=0;e<i.length;e++){let t={...i[e]};for(;e+1<i.length&&t.dia===i[e+1].dia&&t.fin===i[e+1].inicio&&t.aula===i[e+1].aula;)t.fin=i[e+1].fin,e++;n.push(t)}return n}((p[e.id]||[]).filter(e=>e.dia===d.toLowerCase()))){let[t,a]=i.inicio.split(":").map(Number),[l,d]=i.fin.split(":").map(Number),s=60*t+a,c=60*l+d,[p,f]=o.split(":").map(Number),u=60*p+f;u>=s&&u<c&&!h&&(n===r.findIndex(e=>{let[i,n]=e.split(":").map(Number);return 60*i+n>=s})?(h={...i,materia:e},m=!0):(h={...i,materia:e},m=!1))}if(h&&m){let[o,a]=h.inicio.split(":").map(Number),[d,s]=h.fin.split(":").map(Number),c=60*o+a,p=60*d+s,m=0;for(let e=n;e<r.length;e++){let[i,n]=r[e].split(":").map(Number),t=60*i+n;t>=c&&t<p&&m++}m=Math.max(1,m);for(let t=1;t<m;t++)e["".concat(n+t,"-").concat(i)]=!0;l.push((0,t.jsx)("td",{rowSpan:m,style:{padding:0,background:"transparent",verticalAlign:"middle"},children:(0,t.jsxs)("div",{className:"bloque-materia",onClick:()=>y({open:!0,bloque:h,materia:h.materia}),children:[(0,t.jsx)("div",{style:{width:"100%",textAlign:"center",fontWeight:800,fontSize:"1.13em",marginBottom:2},children:h.materia.nombre}),(0,t.jsxs)("span",{children:[h.inicio," - ",h.fin," | Aula: ",h.aula]})]})},i))}else{if(c.some(e=>(p[e.id]||[]).some(e=>{if(e.dia!==d.toLowerCase())return!1;let[i,n]=e.inicio.split(":").map(Number),[t,a]=e.fin.split(":").map(Number),r=60*i+n,l=60*t+a,[s,c]=o.split(":").map(Number),h=60*s+c;return h>r&&h<l}))){e[s]=!0;continue}l.push((0,t.jsx)("td",{className:"vacio"},i))}}i.push((0,t.jsx)("tr",{children:l},o))}return i})()})]})}),(0,t.jsx)("div",{style:{width:"98vw",maxWidth:"100vw",margin:"2em auto 0 auto",display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"0.7em"},children:c.map(e=>(0,t.jsxs)("div",{style:{background:"#f8fafc",borderRadius:10,boxShadow:"0 1px 4px #2563eb11",border:"1.2px solid #c7d2fe",padding:"0.7em 0.7em 0.5em 0.7em",fontWeight:600,color:"#1e293b",fontSize:"1em",display:"flex",flexDirection:"column",gap:"0.3em",cursor:"pointer",minHeight:0,minWidth:0,alignItems:"flex-start",transition:"box-shadow 0.2s, border 0.2s",userSelect:"none"},onClick:()=>{console.log("Abriendo modal para:",e),u({open:!0,materia:e}),b([{dia:"",inicio:"",fin:"",aula:""}])},children:[(0,t.jsx)("div",{style:{fontSize:"1.08em",fontWeight:800,color:"#2563eb",marginBottom:2,lineHeight:1.1},children:e.nombre}),p[e.id]&&p[e.id].length>0?p[e.id].map((i,n)=>(0,t.jsxs)("div",{style:{background:"#fff",borderRadius:6,padding:"0.25em 0.5em",color:"#334155",fontWeight:500,fontSize:"0.97em",boxShadow:"0 1px 2px #2563eb08",border:"1px solid #c7d2fe",marginBottom:2,lineHeight:1.2,display:"flex",alignItems:"center",gap:6},children:[(0,t.jsx)("span",{style:{fontWeight:700},children:i.dia.charAt(0).toUpperCase()+i.dia.slice(1)})," ",i.inicio," - ",i.fin," ",(0,t.jsxs)("span",{style:{color:"#64748b",marginLeft:6},children:["Aula: ",i.aula]}),(0,t.jsx)("button",{title:"Editar",onClick:n=>{n.stopPropagation(),y({open:!0,bloque:i,materia:e})},style:{background:"none",border:"none",color:"#2563eb",fontSize:18,marginLeft:4,cursor:"pointer",padding:0,lineHeight:1},children:"✏️"}),(0,t.jsx)("button",{title:"Eliminar",onClick:n=>{var t,o;n.stopPropagation(),window.confirm("\xbfEliminar este bloque de horario?")&&(t=e.id,o=i.dia,fetch("".concat("http://localhost:5000","/api/horarios"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({materiaId:t,dia:o})}).then(()=>{fetch("".concat("http://localhost:5000","/api/horarios")).then(e=>e.json()).then(e=>{if("success"===e.status&&e.data){let i={};e.data.forEach(e=>{e.Horarios&&e.Horarios.length>0&&(i[e.id]=e.Horarios.map(e=>({dia:e.dia,inicio:e.inicio,fin:e.fin,aula:e.aula})))}),m(i)}})}))},style:{background:"none",border:"none",color:"#ef4444",fontSize:18,marginLeft:2,cursor:"pointer",padding:0,lineHeight:1},children:"\uD83D\uDDD1️"})]},n)):(0,t.jsx)("div",{style:{color:"#64748b",fontWeight:400,fontSize:"0.95em"},children:"Sin horario asignado"})]},e.id))}),f.open&&(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0008",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsxs)("div",{style:{background:"#fff",borderRadius:18,padding:"2.5em 2em",minWidth:340,maxWidth:600,width:"98vw",boxSizing:"border-box",boxShadow:"0 6px 40px #2563eb33",position:"relative"},children:[(0,t.jsx)("button",{onClick:j,style:{position:"absolute",top:12,right:16,background:"none",border:"none",fontSize:22,color:"#64748b",cursor:"pointer"},children:"\xd7"}),(0,t.jsxs)("h2",{style:{margin:0,marginBottom:18,color:"#2563eb",fontWeight:800,fontSize:"1.3em",textAlign:"center"},children:["Asignar horarios a ",null==(s=f.materia)?void 0:s.nombre]}),g.map((e,i)=>(0,t.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:8,alignItems:"center",marginBottom:10},children:[(0,t.jsxs)("select",{value:e.dia,onChange:e=>v(i,"dia",e.target.value),style:{flex:"1 1 120px",minWidth:90},children:[(0,t.jsx)("option",{value:"",children:"D\xeda"}),a.map(e=>(0,t.jsx)("option",{value:e.toLowerCase(),children:e},e))]}),(0,t.jsx)("input",{type:"time",value:e.inicio,onChange:e=>v(i,"inicio",e.target.value),style:{width:80,flex:"1 1 80px"}}),(0,t.jsx)("span",{style:{flex:"0 0 10px"},children:"-"}),(0,t.jsx)("input",{type:"time",value:e.fin,onChange:e=>v(i,"fin",e.target.value),style:{width:80,flex:"1 1 80px"}}),(0,t.jsx)("input",{type:"text",value:e.aula,onChange:e=>v(i,"aula",e.target.value),placeholder:"Aula",style:{width:60,flex:"1 1 60px"}}),g.length>1&&(0,t.jsx)("button",{onClick:()=>{b(e=>e.filter((e,n)=>n!==i))},style:{background:"none",border:"none",color:"#ef4444",fontWeight:700,fontSize:18,cursor:"pointer"},children:"\uD83D\uDDD1️"})]},i)),(0,t.jsx)("button",{onClick:()=>{b(e=>[...e,{dia:"",inicio:"",fin:"",aula:""}])},style:{margin:"0.5em 0 1em 0",background:"#e0e7ff",color:"#2563eb",border:"none",borderRadius:8,padding:"0.5em 1.2em",fontWeight:700,fontSize:"1em",cursor:"pointer"},children:"+ Agregar d\xeda"}),(0,t.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:12},children:[(0,t.jsx)("button",{onClick:()=>{for(let e of g)if(!e.dia||!e.inicio||!e.fin)return;Promise.all(g.map(e=>e.dia.toLowerCase()).map(e=>fetch("".concat("http://localhost:5000","/api/horarios"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({materiaId:f.materia.id,dia:e})}))).then(()=>{Promise.all(g.map(e=>fetch("".concat("http://localhost:5000","/api/horarios"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({materiaId:f.materia.id,...e,dia:e.dia.toLowerCase()})}))).then(()=>{fetch("".concat("http://localhost:5000","/api/horarios")).then(e=>e.json()).then(e=>{if("success"===e.status&&e.data){let i={};e.data.forEach(e=>{e.Horarios&&e.Horarios.length>0&&(i[e.id]=e.Horarios.map(e=>({dia:e.dia,inicio:e.inicio,fin:e.fin,aula:e.aula})))}),m(i)}j()})})})},style:{background:"#2563eb",color:"#fff",border:"none",borderRadius:8,padding:"0.6em 1.2em",fontWeight:700,fontSize:"1.05em",cursor:"pointer",marginBottom:6},children:"Guardar"}),(0,t.jsx)("button",{onClick:j,style:{background:"#f3f4f6",color:"#64748b",border:"none",borderRadius:8,padding:"0.6em 1.2em",fontWeight:700,fontSize:"1.05em",cursor:"pointer",marginBottom:6},children:"Cancelar"})]})]})}),x.open&&(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0008",zIndex:1100,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsxs)("div",{style:{background:"#fff",borderRadius:18,padding:"2.5em 2em",minWidth:340,maxWidth:600,width:"98vw",boxSizing:"border-box",boxShadow:"0 6px 40px #2563eb33",position:"relative"},children:[(0,t.jsx)("button",{onClick:w,style:{position:"absolute",top:12,right:16,background:"none",border:"none",fontSize:22,color:"#64748b",cursor:"pointer"},children:"\xd7"}),(0,t.jsxs)("h2",{style:{margin:0,marginBottom:18,color:"#2563eb",fontWeight:800,fontSize:"1.2em",textAlign:"center"},children:["Editar horario de ",null==(e=x.materia)?void 0:e.nombre]}),(0,t.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:8,alignItems:"center",marginBottom:18},children:[(0,t.jsxs)("select",{value:(null==(i=x.bloque)?void 0:i.dia)||"",onChange:e=>y(i=>({...i,bloque:{...i.bloque,dia:e.target.value}})),style:{flex:"1 1 120px",minWidth:90},children:[(0,t.jsx)("option",{value:"",children:"D\xeda"}),a.map(e=>(0,t.jsx)("option",{value:e.toLowerCase(),children:e},e))]}),(0,t.jsx)("input",{type:"time",value:(null==(n=x.bloque)?void 0:n.inicio)||"",onChange:e=>y(i=>({...i,bloque:{...i.bloque,inicio:e.target.value}})),style:{width:80,flex:"1 1 80px"}}),(0,t.jsx)("span",{style:{flex:"0 0 10px"},children:"-"}),(0,t.jsx)("input",{type:"time",value:(null==(l=x.bloque)?void 0:l.fin)||"",onChange:e=>y(i=>({...i,bloque:{...i.bloque,fin:e.target.value}})),style:{width:80,flex:"1 1 80px"}}),(0,t.jsx)("input",{type:"text",value:(null==(d=x.bloque)?void 0:d.aula)||"",onChange:e=>y(i=>({...i,bloque:{...i.bloque,aula:e.target.value}})),placeholder:"Aula",style:{width:60,flex:"1 1 60px"}})]}),(0,t.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:12},children:[(0,t.jsx)("button",{onClick:()=>{let e=x.bloque;e.dia&&e.inicio&&e.fin&&fetch("".concat("http://localhost:5000","/api/horarios"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({materiaId:x.materia.id,dia:x.bloque.dia})}).then(()=>{fetch("".concat("http://localhost:5000","/api/horarios"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({materiaId:x.materia.id,...e,dia:e.dia.toLowerCase()})}).then(()=>{fetch("".concat("http://localhost:5000","/api/horarios")).then(e=>e.json()).then(e=>{if("success"===e.status&&e.data){let i={};e.data.forEach(e=>{e.Horarios&&e.Horarios.length>0&&(i[e.id]=e.Horarios.map(e=>({dia:e.dia,inicio:e.inicio,fin:e.fin,aula:e.aula})))}),m(i)}w()})})})},style:{background:"#2563eb",color:"#fff",border:"none",borderRadius:8,padding:"0.6em 1.2em",fontWeight:700,fontSize:"1.05em",cursor:"pointer",marginBottom:6},children:"Guardar"}),(0,t.jsx)("button",{onClick:()=>{fetch("".concat("http://localhost:5000","/api/horarios"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({materiaId:x.materia.id,dia:x.bloque.dia})}).then(()=>{fetch("".concat("http://localhost:5000","/api/horarios")).then(e=>e.json()).then(e=>{if("success"===e.status&&e.data){let i={};e.data.forEach(e=>{e.Horarios&&e.Horarios.length>0&&(i[e.id]=e.Horarios.map(e=>({dia:e.dia,inicio:e.inicio,fin:e.fin,aula:e.aula})))}),m(i)}w()})})},style:{background:"#ef4444",color:"#fff",border:"none",borderRadius:8,padding:"0.6em 1.2em",fontWeight:700,fontSize:"1.05em",cursor:"pointer",marginBottom:6},children:"Eliminar"}),(0,t.jsx)("button",{onClick:w,style:{background:"#f3f4f6",color:"#64748b",border:"none",borderRadius:8,padding:"0.6em 1.2em",fontWeight:700,fontSize:"1.05em",cursor:"pointer",marginBottom:6},children:"Cancelar"})]})]})})]})}}},e=>{e.O(0,[636,593,792],()=>e(e.s=4008)),_N_E=e.O()}]);